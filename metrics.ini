[Common]
InitialScreen="ScreenInit"

###########################################################################
###		ATTRACT LOOP SCREENS
###########################################################################
[ScreenInit]
AllowStartToSkip=false
PrepareScreen=true
TimerSeconds=5
StopMusicOnBack=false
ShowCreditDisplay=false
MemoryCardIcons=false

[ScreenAttract]
ShowCreditDisplay=false
FooterOnCommand=visible,false

# the blinking Simply Love logo and nothing else
[ScreenLogo]
PrevScreen="ScreenInit"
NextScreen="ScreenRankingSingle"
HeaderOnCommand=visible,false
TimerSeconds=14
ShowCreditDisplay=true

[ScreenRankingSingle]
Class="ScreenHighScores"
Fallback="ScreenAttract"
PrevScreen="ScreenLogo"
NextScreen="ScreenRankingDouble"

ManualScrolling=false
HighScoresType="HighScoresType_AllSteps"
NumColumns=2
ColumnDifficulty1="Difficulty_Hard"
ColumnDifficulty2="Difficulty_Challenge"
ColumnStepsType1=GetStepsTypeForThisGame("Single")
ColumnStepsType2=GetStepsTypeForThisGame("Single")

NumMostRecentScoresToShow=30
MaxItemsToShow=30

ScrollerOnCommand=xy,_screen.cx,_screen.cy+20;scrollthroughallitems
ScrollerItemTransformFunction=function(self,offset,itemIndex,numItems) self:y(65*offset) end
ScrollerItemsToDraw=7
ScrollerSecondsPerItem=0.5


[ScreenRankingDouble]
Class="ScreenHighScores"
Fallback="ScreenRankingSingle"
PrevScreen="ScreenLogo"
NextScreen="ScreenMemoryCard"
StartScreen=Branch.TitleMenu()
MaxItemsToShow=30

ScrollerOffCommand=diffusealpha,0
ColumnStepsType1=GetStepsTypeForThisGame("Double")
ColumnStepsType2=GetStepsTypeForThisGame("Double")

HeaderOffCommand=linear,0.2;diffusealpha,0


[ScreenMemoryCard]
Fallback="ScreenAttract"
Class="ScreenAttract"
NextScreen="ScreenRainbow"
PrevScreen="ScreenRainbow"
ForceTimer=true
TimerSeconds=10
HeaderOnCommand=visible,false
TimerOnCommand=visible,false


[ScreenRainbow]
Fallback="ScreenAttract"
NextScreen="ScreenLogo"
PrevScreen="ScreenLogo"
ForceTimer=true
TimerSeconds=10
HeaderOnCommand=visible,false
TimerOnCommand=visible,false
MemoryCardIcons=false



###########################################################################
###		SCREENS BEFORE SelectMusic
###########################################################################
# this is for when we are in Home mode
[ScreenTitleMenu]
PrevScreen="ScreenInit"
IdleTimeoutSeconds=30
IdleTimeoutScreen="ScreenInit"

ChoiceNames="1,2,3,4"
DefaultChoice="1"
Choice1="applydefaultoptions;screen,ScreenSelectColor;text,Dance Mode"
Choice2="screen,ScreenEditMenu;text,Edit Mode"
Choice3="screen,ScreenOptionsService;text,Options"
Choice4="screen,ScreenExit;text,Exit"

ScrollerX=_screen.cx
ScrollerY=_screen.cy+_screen.h/3.8
ScrollerTransform=function(self,offset,itemIndex,numItems) self:y(22*offset) end

HeaderOnCommand=visible,false
FooterOnCommand=visible,false


# this is for when we are in Free/Pay mode
[ScreenTitleJoin]
Fallback="ScreenTitleMenu"
ChoiceNames="1"
Choice1="applydefaultoptions;screen,ScreenSelectColor;text,Dance Mode"
# Choice2="screen,ScreenUnlock;text,Enter Unlock Code"
ScrollerOnCommand=visible,false


# This screen prompts the user to type in an unlock code.
[ScreenUnlock]
Fallback="ScreenTextEntry"
PrevScreen="ScreenTitleJoin"
NextScreen="ScreenUnlock2"

HeaderOnCommand=visible,false
FooterOnCommand=visible,false
ShowCreditDisplay=false

QuestionY=_screen.cy-50


# This screen handles how to inform the user whether anything
# was successfully unlocked or not.
[ScreenUnlock2]
Fallback="ScreenPrompt"
PrevScreen="ScreenTitleJoin"
NextScreen="ScreenTitleJoin"

HeaderOnCommand=visible,false
FooterOnCommand=visible,false
ShowCreditDisplay=false


# # Changes applied to [UnlockManager] while SM is running
# # don't get picked up when metrics are refreshed via Shift+F2 (it seems?)
# # so, make sure things are the way you want them to be (or restart Stepmania).
# [UnlockManager]
# # determine if songs loaded via AdditionalSongs should be locked.
# SongsNotAdditional=false
#
# # codes NEED to all be unique; duplicate codes will cause SM to crash
# UnlockNames="1,2,3"
# Unlock1Command=song,"dbk5/Applause";code,"blah";
# Unlock2Command=song,"dbk5/I Need Your Love";code,"blahblah";
# Unlock3Command=song,"dbk5/Killin It - Mutrix Remix";code,"blahblahblah";


# Colored hearts, sir.
# Colored hearts as far as the eye can see.
[ScreenSelectColor]
Fallback="ScreenWithMenuElements"
PrevScreen=Branch.TitleMenu()
NextScreen="ScreenSelectPlayMode"
TimerSeconds=20


[ScreenSelectPlayMode]
Class="ScreenSelectMaster"
Fallback="ScreenSelectMaster"
PrevScreen=Branch.TitleMenu()

StyleIcon=false
ShowFooter=true

TimerSeconds=20

ChoiceNames="Normal,Nonstop"
ChoiceNormal="playmode,regular; name,Normal; screen,ScreenSelectStyle"
ChoiceNonstop="playmode,nonstop; name,Nonstop; screen,ScreenSelectStyle"
DefaultChoice="Normal"

ShowScroller=false
ShowIcon=true
WrapCursor=true
SharedSelection=true

UseIconMetrics=true

IconChoiceNormalX=_screen.cx - _screen.w/5
IconChoiceNormalY=_screen.cy
IconChoiceNormalOnCommand=

IconChoiceNonstopX=_screen.cx + _screen.w/5
IconChoiceNonstopY=_screen.cy
IconChoiceNonstopOnCommand=


[ScreenSelectStyle]
Class="ScreenSelectMaster"
Fallback="ScreenSelectMaster"
PrevScreen="ScreenSelectColor"
NextScreen=Branch.AfterSelectStyle()

UpdateOnMessage="PlayerJoined"

ChoiceNames=(GAMESTATE:GetCurrentGame():GetName()=="dance" and ThemePrefs.Get("AllowDanceSolo")) and "Single,Versus,Double,Solo" or GAMESTATE:GetCurrentGame():GetName()=="techno" and "Single8,Versus8,Double8" or "Single,Versus,Double"

ChoiceSingle="style,single;name,Single;screen,ScreenProfileLoad"
ChoiceVersus="style,versus;name,Versus;screen,ScreenProfileLoad"
ChoiceDouble="style,double;name,Double;screen,ScreenProfileLoad"
ChoiceSolo="style,solo;name,Solo;screen,ScreenProfileLoad"

ChoiceSingle8="style,single8;name,Single;screen,ScreenProfileLoad"
ChoiceVersus8="style,versus8;name,Versus;screen,ScreenProfileLoad"
ChoiceDouble8="style,double8;name,Double;screen,ScreenProfileLoad"

DefaultChoice=GAMESTATE:GetCurrentGame():GetName()=="techno" and "Single8" or "Single"

ShowFooter=true
ShowScroller=false
ShowIcon=true
WrapCursor=true
SharedSelection=true

UseIconMetrics=true

IconChoiceSingleX=(GAMESTATE:GetCurrentGame():GetName()=="dance" and ThemePrefs.Get("AllowDanceSolo")) and _screen.w/4-_screen.w/8 or _screen.cx-_screen.w/4
IconChoiceVersusX=(GAMESTATE:GetCurrentGame():GetName()=="dance" and ThemePrefs.Get("AllowDanceSolo")) and (_screen.w/4)*2-_screen.w/8 or _screen.cx
IconChoiceDoubleX=(GAMESTATE:GetCurrentGame():GetName()=="dance" and ThemePrefs.Get("AllowDanceSolo")) and (_screen.w/4)*3-_screen.w/8 or _screen.cx+_screen.w/4
IconChoiceSoloX=(_screen.w/4)*4-_screen.w/8

IconChoiceSingleY=_screen.cy
IconChoiceVersusY=_screen.cy
IconChoiceDoubleY=_screen.cy
IconChoiceSoloY=_screen.cy

IconChoiceSingle8X=_screen.cx-_screen.w/4
IconChoiceVersus8X=_screen.cx
IconChoiceDouble8X=_screen.cx+_screen.w/4

[ScreenProfileLoad]
ShowFooter=true
StyleIcon=false
NextScreen=Branch.AfterSelectStyle()
ShowCreditDisplay=false

###########################################################################
###		Between game cycles
###		the simple question remains:
###		shall we continue?
###########################################################################

# Profile Saving occurs after every ScreenEvaluation
[ScreenProfileSave]
HeaderOnCommand=visible,false
StyleIcon=false
NextScreen=Branch.AfterProfileSave()
Summary=false
ShowCreditDisplay=false

[ScreenPlayAgain]
Fallback="ScreenWithMenuElements"
NextScreen=SL.Global.ScreenAfter.PlayAgain
TimerSeconds=15

###########################################################################
###		Screen Select Music (and company)
###########################################################################

[ScreenSortList]
Fallback="ScreenWithMenuElements"
NextScreen="ScreenSelectMusic"
PrevScreen="ScreenSelectMusic"
HeaderOnCommand=visible,false
FooterOnCommand=visible,false
ShowCreditDisplay=false


###########################################################################
###		After the Game (of love, baby; all I'm gonna do is eat gravy.)
###########################################################################

[ScreenNameEntryTraditional]
PrevScreen="ScreenProfileSaveSummary"
NextScreen="ScreenProfileSaveSummary"
HeaderOnCommand=visible,false
FooterOnCommand=visible,false
TimerSeconds=60
TimerOnCommand=hide_if,not PREFSMAN:GetPreference("MenuTimer");draworder,99;
ForceTimer=false

[ScreenProfileSaveSummary]
Fallback="ScreenProfileSave"
NextScreen=Branch.AfterProfileSaveSummary()
PrevScreen=Branch.AfterProfileSaveSummary()

[ScreenGameOver]
Class="ScreenAttract"
Fallback="ScreenAttract"
PrevScreen=Branch.AfterInit()
NextScreen=Branch.AfterInit()
TimerSeconds=30
ForceTimer=true
TimerOnCommand=visible,false
PlayMusic=true


###########################################################################
###		Classes of Screens (that are mostly just inherited from)
###########################################################################
[Screen]
StyleIcon=false
ShowHelp=true
ShowCreditDisplay=false


[ScreenWithMenuElements]
TimerX=_screen.w-30
TimerY=-1
TimerOnCommand=hide_if,not PREFSMAN:GetPreference("MenuTimer");draworder,99;

HeaderX=0
HeaderY=0
FooterX=_screen.cx
FooterY=_screen.h

MemoryCardIcons=true

MemoryCardDisplayP1X=WideScale(18,24);
MemoryCardDisplayP1Y=SCREEN_BOTTOM-14
MemoryCardDisplayP1OnCommand=draworder,96;zoom,WideScale(0.175, 0.215)

MemoryCardDisplayP2X=SCREEN_RIGHT-WideScale(18,24)
MemoryCardDisplayP2Y=SCREEN_BOTTOM-14
MemoryCardDisplayP2OnCommand=draworder,96;zoom,WideScale(0.175, 0.215)

[ScreenSelect]
DoublePressToSelect=false
UseTwoLists=false
OptionOrderBUp=""
OptionOrderBDown=""
OptionOrderBLeft=""
OptionOrderBRight=""
OptionOrderBAuto=""

[ScreenSelectMaster]
Fallback="ScreenWithMenuElements"
ShowCreditDisplay=true

TimerSeconds=-1
StopMusicOnBack=false
HelpText=ScreenString("HelpText")

[ScreenHighScores]
NextScreen=Branch.TitleMenu()
TimerSeconds=1

[ScreenPrompt]
QuestionY=_screen.cy-60
QuestionOnCommand=wrapwidthpixels,600

[ScreenTextEntry]
QuestionY=_screen.cy-64
QuestionOnCommand=wrapwidthpixels,600
AnswerY=_screen.cy+16

## Options Section #############################################################

[OptionsCursor]
CanGoLeftX=-17
CanGoLeftY=0
CanGoLeftOnCommand=halign,1;

CanGoRightX=16
CanGoRightY=0
CanGoRightOnCommand=halign,0;

[OptionsCursorP1]
Fallback="OptionsCursor"
LeftOnCommand=diffuse,PlayerColor(PLAYER_1)
MiddleOnCommand=diffuse,PlayerColor(PLAYER_1)
RightOnCommand=diffuse,PlayerColor(PLAYER_1)

LeftX=0
MiddleX=0
RightX=0

LeftY=-1
MiddleY=-1
RightY=-1

[OptionsCursorP2]
Fallback="OptionsCursor"
LeftOnCommand=diffuse,PlayerColor(PLAYER_2)
MiddleOnCommand=diffuse,PlayerColor(PLAYER_2)
RightOnCommand=diffuse,PlayerColor(PLAYER_2)

LeftX=0
MiddleX=0
RightX=0

LeftY=1
MiddleY=1
RightY=1
#### end OptionsCursor ####

[OptionsUnderline]

[OptionsUnderlineP1]
Fallback="OptionsUnderline"
LeftOnCommand=diffuse,PlayerColor(PLAYER_1)
MiddleOnCommand=diffuse,PlayerColor(PLAYER_1)
RightOnCommand=diffuse,PlayerColor(PLAYER_1)

[OptionsUnderlineP2]
Fallback="OptionsUnderline"
LeftOnCommand=diffuse,PlayerColor(PLAYER_2)
MiddleOnCommand=diffuse,PlayerColor(PLAYER_2)
RightOnCommand=diffuse,PlayerColor(PLAYER_2)



#### OptionRow #############################################################
[OptionRow]
ShowBpmInSpeedTitle=false

TitleX=WideScale(SCREEN_LEFT+26,SCREEN_LEFT+40)
TitleOnCommand=%function(self)\
	self:zoom(0.8); \
	self:halign(0); \
	self:vertspacing(-8); \
	self:maxwidth(_screen.w*WideScale(0.2,0.15)); \
	local text = self:GetText(); \
	if text == THEME:GetString("OptionTitles", "SpeedMod") then \
		self:settext(text.." (".. GetDisplayBPMs() .. ")");\
	end \
end
TitleGainFocusCommand=%function(self)\
	self:diffuse(PlayerColor(PLAYER_1)); \
	MESSAGEMAN:Broadcast("OptionRowChanged", {Title=self}); \
end
TitleLoseFocusCommand=diffuse,color("#FFFFFF")

FrameX=_screen.cx-WideScale(30,39)
FrameY=0
FrameOnCommand=diffusealpha,0.7
FrameGainFocusCommand=diffuse,color("#293238");diffusealpha,0.8
FrameLoseFocusCommand=diffuse,color("#071016");diffusealpha,0.8

ItemsStartX=WideScale(SCREEN_LEFT+150,SCREEN_LEFT+170)
ItemsEndX=_screen.w-250
ItemsLongRowP1X=WideScale(_screen.cx-100,_screen.cx-130)
ItemsLongRowP2X=WideScale(_screen.cx+100,_screen.cx+100)

ItemOnCommand=zoom,0.75;
ItemGainFocusCommand=
ItemLoseFocusCommand=


[OptionRowSimple]
Fallback="OptionRow"
TitleOnCommand=zoom,0.8;halign,0;vertspacing,-8;
ItemOnCommand=diffuse,color("#FFFFFF");zoom,0.8;vertspacing,-8
FrameDisabledCommand=diffuse,color("#000000");

[OptionRowSimpleService]
Fallback="OptionRowSimple"
TitleGainFocusCommand=%function(self) \
	local index = SCREENMAN:GetTopScreen():GetCurrentRowIndex(PLAYER_1) + SL.Global.ActiveColorIndex + 1 \
	self:diffuse( GetHexColor(index) ) \
end

[OptionRowExit]
Fallback="OptionRow"
FrameOnCommand=diffusealpha,0.7
FrameGainFocusCommand=diffuse,color("#293238");diffusealpha,0.8
FrameLoseFocusCommand=diffuse,color("#071016");diffusealpha,0.8
TitleGainFocusCommand=diffuse,color("#000000")
ItemOnCommand=zoom,0.8


[OptionRowSimpleExit]
Fallback="OptionRow"
FrameGainFocusCommand=diffuse,PlayerColor(PLAYER_1);diffusealpha,1
TitleGainFocusCommand=diffuse,color("#000000")
ItemOnCommand=visible,false

#### end OptionRow #############################################################






### Options Screens ###
[ScreenOptionsMaster]
# this currently overrides people who edit the metrics in the default theme.
# there really isn't much recourse for this save for making the options
# cherry-pickable via a Lua menu.

Perspective="5;selectone"
PerspectiveDefault="mod,overhead"
Perspective,1="mod,overhead;name,Overhead"
Perspective,2="mod,hallway;name,Hallway"
Perspective,3="mod,distant;name,Distant"
Perspective,4="mod,incoming;name,Incoming"
Perspective,5="mod,space;name,Space"

Accel="5;selectmultiple"
AccelDefault="mod,no boost,no brake,no wave,no expand,no boomerang"
Accel,1="mod,boost;name,Boost"
Accel,2="mod,brake;name,Brake"
Accel,3="mod,wave;name,Wave"
Accel,4="mod,expand;name,Expand"
Accel,5="mod,boomerang;name,Boomerang"

Effect="10;selectmultiple"
EffectDefault="mod,no drunk,no dizzy,no confusion,no flip,no invert,no tornado,no tipsy,no bumpy,no beat"
Effect,1="mod,drunk;name,Drunk"
Effect,2="mod,dizzy;name,Dizzy"
Effect,3="mod,confusion;name,Confusion"
Effect,4="mod,-100% mini;name,Big"
Effect,5="mod,flip;name,Flip"
Effect,6="mod,invert;name,Invert"
Effect,7="mod,tornado;name,Tornado"
Effect,8="mod,tipsy;name,Tipsy"
Effect,9="mod,bumpy;name,Bumpy"
Effect,10="mod,beat;name,Beat"

Appearance="5;selectmultiple"
AppearanceDefault="mod,no hidden,no sudden,no stealth,no blink,no randomvanish"
Appearance,1="mod,hidden;name,Hidden"
Appearance,2="mod,sudden;name,Sudden"
Appearance,3="mod,stealth;name,Stealth"
Appearance,4="mod,blink;name,Blink"
Appearance,5="mod,randomvanish;name,R.Vanish"

Turn="6;selectone"
TurnDefault="mod,no turn"
Turn,1="mod,no turn;name,None"
Turn,2="mod,mirror;name,Mirror"
Turn,3="mod,left;name,Left"
Turn,4="mod,right;name,Right"
Turn,5="mod,shuffle;name,Shuffle"
Turn,6="mod,supershuffle;name,Blender"

Insert="7;selectmultiple"
InsertDefault="mod,no wide,no big,no quick,no skippy,no echo,no stomp,no bmrize"
Insert,1="mod,wide;name,Wide"
Insert,2="mod,big;name,Big"
Insert,3="mod,quick;name,Quick"
Insert,4="mod,bmrize;name,BMRize"
Insert,5="mod,skippy;name,Skippy"
Insert,6="mod,echo;name,Echo"
Insert,7="mod,stomp;name,Stomp"

Remove="4;selectmultiple"
RemoveDefault="mod,no little,no nojumps,no nohands,no noquads"
Remove,1="mod,little;name,Little"
Remove,2="mod,nojumps;name,NoJumps"
Remove,3="mod,nohands;name,NoHands"
Remove,4="mod,noquads;name,NoQuads"

Scroll="5;selectmultiple"
ScrollDefault="mod,no reverse,no split,no alternate,no cross,no centered"
Scroll,1="mod,reverse;name,Reverse"
Scroll,2="mod,split;name,Split"
Scroll,3="mod,alternate;name,Alternate"
Scroll,4="mod,cross;name,Cross"
Scroll,5="mod,centered;name,Centered"

Holds="3;selectmultiple"
HoldsDefault="mod,no noholds,no planted,no twister,no holdrolls"
Holds,1="mod,planted;name,Planted"
Holds,2="mod,twister;name,Twister"
Holds,3="mod,holdrolls;name,HoldRolls"

Mines="4"
MinesDefault="mod,no nomines,no mines,no attackmines"
Mines,1="mod,nomines;name,Off"
Mines,2="name,On"
Mines,3="mod,mines;name,Add"
Mines,4="mod,attackmines;name,AttackMines"


[ScreenPlayerOptions]
Class="ScreenPlayerOptions"
Fallback="ScreenOptions"

NextScreen=SL.Global.ScreenAfter.PlayerOptions
TimerSeconds=90
TimerStealth=false
TimerOnCommand=hide_if,not PREFSMAN:GetPreference("MenuTimer");draworder,99;
TimerOffCommand=
ForceTimer=false
ShowHeader=true

OptionRowExitMetricsGroup="OptionRowExit"
RowPositionTransformFunction=function(self,positionIndex,itemIndex,numItems) self:y( (_screen.cy-170) + (_screen.h*0.065*positionIndex) ); end

RepeatRate=20
AllowRepeatingChangeValueInput=true
LineNames="SpeedModType,SpeedMod,Mini,Perspective,NoteSkin2,Judgment,BackgroundFilter,MusicRate,Difficulty,ScreenAfterPlayerOptions"

##### Most Used #####
# optionrows assembled by ./Scripts/SL-PlayerOptions.lua
LineSpeedModType="lua,CustomOptionRow('SpeedModType')"
LineSpeedMod="lua,CustomOptionRow('SpeedMod')"
LineMini="lua,CustomOptionRow('Mini')"
LineNoteSkin2="lua,CustomOptionRow('NoteSkin')"
LineJudgment="lua,CustomOptionRow('JudgmentGraphic')"
LineBackgroundFilter="lua,CustomOptionRow('BackgroundFilter')"
LineMusicRate="lua,CustomOptionRow('MusicRate')"
LineScreenAfterPlayerOptions="lua,CustomOptionRow('ScreenAfterPlayerOptions')"
LineHide="lua,CustomOptionRow('Hide')"
LineGameplayExtras="lua,CustomOptionRow('GameplayExtras')"
LineMeasureCounter="lua,CustomOptionRow('MeasureCounter')"
# lists assembled by the engine
LinePerspective="list,Perspective"
LineNoteSkin="list,NoteSkins"
LineDifficulty="list,Steps"

## These OptionRows appear on [ScreenPlayerOptions2] and [ScreenAttackMenu],
## define them here anyway so that of those screens can fallback on this one
LineTurn="list,Turn"
LineScroll="list,Scroll"

## effects ##
Line11="list,Accel"
Line12="list,Effect"
Line13="list,Appearance"

ExplanationP1X=WideScale(30,50)
ExplanationP1Y=SCREEN_BOTTOM-105
ExplanationP1OnCommand=draworder,3;zoom,WideScale(0.65,0.75);diffuse,PlayerColor(PLAYER_1);wrapwidthpixels,_screen.cx*WideScale(1.15,1.5);halign,0;valign,0;vertspacing,-8;cropright,1;linear,0.5;cropright,0
ExplanationP1OffCommand=linear,0.2;diffusealpha,0

ExplanationP2X=_screen.cx+WideScale(10,30)
ExplanationP2Y=SCREEN_BOTTOM-105
ExplanationP2OnCommand=draworder,3;zoom,WideScale(0.65,0.75);diffuse,PlayerColor(PLAYER_2);wrapwidthpixels,_screen.cx*WideScale(1.15,1.5);halign,0;valign,0;vertspacing,-8;cropright,1;linear,0.5;cropright,0
ExplanationP2OffCommand=linear,0.2;diffusealpha,0



[ScreenPlayerOptions2]
Class="ScreenPlayerOptions"
Fallback="ScreenPlayerOptions"
PrevScreen="ScreenPlayerOptions"
NextScreen=SL.Global.ScreenAfter.PlayerOptions2
NavigationMode="toggle"

LineNames="Turn,Scroll,7,8,9,10,11,12,13,Attacks,Hide,GameplayExtras,MeasureCounter,Vocalize,ScreenAfterPlayerOptions2"
# optionrows assembled by custom lua
LineVocalize="lua,CustomOptionRow('Vocalize')"
LineScreenAfterPlayerOptions2="lua,CustomOptionRow('ScreenAfterPlayerOptions2')"
# TimingWindowScale is listed here, but disabled by default
# if you want to experiment with it, add "TimingWindowScale" to LineNames=
LineTimingWindowScale="lua,CustomOptionRow('TimingWindowScale')"

# lists assembled by the engine -- add/remove note types
Line7="list,Insert"
Line8="list,Remove"
Line9="list,Holds"
Line10="list,Mines"
LineAttacks="list,Attacks"

[ScreenAttackMenu]
Class="ScreenPlayerOptions"
Fallback="ScreenPlayerOptions"
TimerSeconds=-1
NavigationMode="toggle"

LineNames="SpeedModType,SpeedMod,MusicRate,Mini,Perspective,Turn,Scroll,11,12,13"


## edit options
[ScreenEditOptions]
Fallback="ScreenPlayerOptions"
LineNames="SpeedModType,SpeedMod,Mini,Perspective,NoteSkin,MusicRate,Assist,ShowBGChangesPlay"
LineAssist="list,Assist"
LineShowBGChangesPlay="conf,EditorShowBGChangesPlay"


#### Base Options Screen ####
[ScreenOptions]
StopMusicOnBack=false
HelpText=ScreenString("HelpTextOptions")
ShowFooter=true
FooterOnCommand=draworder,-1;

ContainerOnCommand=zoom,1.1;accelerate,0.3;diffusealpha,1;
ContainerOffCommand=accelerate,0.3;diffusealpha,0

RowInitCommand=diffusealpha,0;
RowOnCommand=linear,0.2;diffusealpha,1;draworder,-1
RowOffCommand=linear,0.2;diffusealpha,0
RowPositionTransformFunction=function(self,positionIndex,itemIndex,numItems) self:y( (_screen.cy-180) + (32*positionIndex) ); end
NumRowsShown=10

LineHighlightP1OnCommand=visible,false
LineHighlightP2OnCommand=visible,false

ShowOptionIcons=false
SeparateExitRow=false

TweenSeconds=0.1
CursorTweenSeconds=0.1

ExplanationP1X=SCREEN_LEFT+40
ExplanationP1Y=SCREEN_BOTTOM-65
ExplanationP1OnCommand=draworder,1;zoom,0.75;diffuse,Color.Black;wrapwidthpixels,_screen.cx*1.5;halign,0;valign,0;cropright,1;linear,0.5;cropright,0;vertspacing,-8
ExplanationP1OffCommand=

ExplanationP2X=WideScale(SCREEN_RIGHT-100,SCREEN_RIGHT-200)
ExplanationP2Y=SCREEN_BOTTOM-65
ExplanationP2OnCommand=draworder,1;zoom,0.75;diffuse,Color.Black;wrapwidthpixels,_screen.cx*1.5;halign,1;valign,0;cropright,1;linear,0.5;cropright,0;vertspacing,-8
ExplanationP2OffCommand=

ExplanationTogetherX=SCREEN_LEFT+40
ExplanationTogetherY=_screen.cy+180
ExplanationTogetherOnCommand=zoom,0.5;diffuse,Color.Black;wrapwidthpixels,_screen.w*1.75;halign,0;vertspacing,-8

BulletX=_screen.cx-_screen.cy
BulletOnCommand=visible,false

ItemsGapX=12
ItemsMinBaseZoom=0.55
ItemsOnCommand=zoom,0.55;
ItemGainFocusCommand=
ItemLoseFocusCommand=

ColorSelected=color("1,1,1,1")
ColorNotSelected=color("0.85,0.85,0.85,1")
CursorOnCommand=zoomx,1.33

DisqualifyP1X=_screen.cx + WideScale(-200,-234)
DisqualifyP1Y=SCREEN_TOP+48
DisqualifyP1OnCommand=zoom,0.25;diffuse,PlayerColor(PLAYER_1)

DisqualifyP2X=_screen.cx + WideScale(200,234)
DisqualifyP2Y=SCREEN_TOP+48
DisqualifyP2OnCommand=zoom,0.25;diffuse,PlayerColor(PLAYER_2)



[ScreenOptionsSimple]
RowPositionTransformFunction=function(self,positionIndex,itemIndex,numItems) self:y( (_screen.cy-180) + (32*positionIndex) ); end
StopMusicOnBack=false
SeparateExitRow=false
ExplanationTogetherOnCommand=zoom,0.65;wrapwidthpixels,_screen.w*1.75;diffuse,Color.Black;vertspacing,-8
#################
OptionRowNormalMetricsGroup="OptionRowSimple"
OptionRowExitMetricsGroup="OptionRowSimpleExit"
CursorOnCommand=visible,false
ShowCreditDisplay=false




[ScreenOptionsServiceChild]
StopMusicOnBack=false
ExplanationTogetherY=_screen.cy+180
ExplanationTogetherOnCommand=zoom,0.65;wrapwidthpixels,_screen.w;diffuse,Color.Black;vertspacing,-4
OptionRowExitMetricsGroup="OptionRowExit"
ShowCreditDisplay=false
AllowRepeatingChangeValueInput=true




[ScreenOptionsService]
Fallback="ScreenOptionsSimple"
OptionRowNormalMetricsGroup="OptionRowSimpleService"
PrevScreen=Branch.TitleMenu()
NextScreen=Branch.TitleMenu()

NumRowsShown=10
LineNames="System,KeyConfig,TestInput,Appearance,BGFit,GraphicsSound,Arcade,Theme,TimingWindows,Advanced,Profiles,Reload"
LineSystem="gamecommand;screen,ScreenSelectGame;name,System Options"
LineTestInput="gamecommand;screen,ScreenTestInput;name,Test Input"
LineAppearance="gamecommand;screen,ScreenAppearanceOptions;name,Appearance Options"
LineGraphicsSound="gamecommand;screen,ScreenOptionsGraphicsSound;name,Graphics/Sound Options"
LineArcade="gamecommand;screen,ScreenOptionsArcade;name,Arcade Options"
LineTheme="gamecommand;screen,ScreenThemeOptions;name,Theme Options"
LineTimingWindows="gamecommand;screen,ScreenOptionsTimingWindows;name,Timing Window Options"
LineAdvanced="gamecommand;screen,ScreenOptionsAdvanced;name,Advanced Options"
LineProfiles="gamecommand;screen,ScreenOptionsManageProfiles;name,Profiles"

ExplanationTogetherY=_screen.cy+180


[ScreenSelectGame]
PrevScreen="ScreenOptionsService"
NextScreen="ScreenOptionsService"

LineNames="Game,Theme,Language,Announcer,Defaultnoteskin,EditorNoteskin"
LineGame="conf,Game"
LineTheme="conf,Theme"
LineLanguage="conf,Language"
LineAnnouncer="conf,Announcer"
LineDefaultnoteskin="conf,DefaultNoteSkin"
LineEditorNoteskin="lua,OptionRowEditorNoteskin()"

[ScreenAppearanceOptions]
PrevScreen="ScreenOptionsService"
NextScreen="ScreenOptionsService"

LineNames="Transliterate,Lyrics,BGBrightness,BGMode,BGNum"
LineTransliterate="conf,ShowNativeLanguage"
LineLyrics="conf,ShowLyrics"
LineBGBrightness="conf,BGBrightness"
LineBGMode="conf,RandomBackgroundMode"
LineBGNum="conf,NumBackgrounds"

[ScreenSetBGFit]
PrevScreen="ScreenOptionsService"
NextScreen="ScreenOptionsService"


[ScreenOptionsTimingWindows]
Fallback="ScreenOptionsServiceChild"
LineNames="TimingWindow"
LineTimingWindow="lua,TimingWindow()"


[ScreenOptionsArcade]
LineNames="Event,Coin,CoinsPerCredit,Premium,SongsPerPlay,OptionsNavigation,MenuButtons,MenuTimer,HighScoresWithSameName,ComboContinues,Disqualification,FailOffForFirstStageEasy,FailOffInBeginner,LockCourseDifficulties,NumberOfHighScoresPerListForMachine,NumberOfHighScoresPerListPerPlayer"
LineEvent="conf,EventMode"
LineCoin="conf,CoinMode"
LineCoinsPerCredit="conf,CoinsPerCredit"
LinePremium="conf,Premium"

LineSongsPerPlay="conf,SongsPerPlay"
LineOptionsNavigation="conf,ArcadeOptionsNavigation"
LineMenuButtons="conf,OnlyDedicatedMenuButtons"
LineMenuTimer="conf,MenuTimer"

LineHighScoresWithSameName="conf,AllowMultipleHighScoreWithSameName"
LineComboContinues="conf,ComboContinuesBetweenSongs"
LineDisqualification="conf,Disqualification"
LineFailOffForFirstStageEasy="conf,FailOffForFirstStageEasy"
LineFailOffInBeginner="conf,FailOffInBeginner"
LineLockCourseDifficulties="conf,LockCourseDifficulties"
LineNumberOfHighScoresPerListForMachine="conf,MaxHighScoresPerListForMachine"
LineNumberOfHighScoresPerListPerPlayer="conf,MaxHighScoresPerListForPlayer"


[ScreenThemeOptions]
Fallback="ScreenOptionsServiceChild"
LineNames="CustomFailSet,CreditStacking,MusicWheelStyle,MusicWheelSpeed,EvalSummary,NameEntry,GameOver,HideStockNoteSksins,DanceSolo"

LineCustomFailSet="lua,ThemePrefsRows.GetRow('AllowFailingOutOfSet')"
LineCreditStacking="lua,ThemePrefsRows.GetRow('NumberOfContinuesAllowed')"
LineMusicWheelStyle="lua,ThemePrefsRows.GetRow('MusicWheelStyle')"
LineMusicWheelSpeed="lua,OptionRowMusicWheelSpeed()"

LineEvalSummary="lua,ThemePrefsRows.GetRow('AllowScreenEvalSummary')"
LineNameEntry="lua,ThemePrefsRows.GetRow('AllowScreenNameEntry')"
LineGameOver="lua,ThemePrefsRows.GetRow('AllowScreenGameOver')"

LineHideStockNoteSksins="lua,ThemePrefsRows.GetRow('HideStockNoteSkins')"
LineDanceSolo="lua,ThemePrefsRows.GetRow('AllowDanceSolo')"


[ScreenOptionsAdvanced]
LineNames="3,4,8,11,13,15,16,28,29,30,PercentageScoring"
Line3="conf,TimingWindowScale"
Line4="conf,LifeDifficulty"
Line8="conf,DefaultFailType"
Line11="conf,AllowW1"
Line13="conf,HiddenSongs"
Line15="conf,AllowExtraStage"
Line16="conf,UseUnlockSystem"
Line28="conf,AutogenSteps"
Line29="conf,AutogenGroupCourses"
Line30="conf,FastLoad"
LinePercentageScoring="conf,PercentageScoring"



[ScreenMapControllers]
LabelP1OnCommand=visible,false
LabelP1OffCommand=

LabelP2OnCommand=visible,false
LabelP2OffCommand=

DevicesX=_screen.cx
DevicesY=SCREEN_TOP+25
DevicesOnCommand=zoom,16/24;strokecolor,color("#222222EE");diffusealpha,0;linear,0.5;diffusealpha,1;
DevicesOffCommand=linear,0.5;diffusealpha,0

LineScrollerOnCommand=%function(self) \
	self:visible(false); \
	self:y(42); \
	self:setsecondsperitem(0.05); \
	self:SetTransformFromHeight(24); \
end;

PrimaryOnCommand=x,_screen.cx;y,-6;zoom,16/24;NoStroke
SecondaryOnCommand=x,_screen.cx;y,6;zoom,12/24;NoStroke
MappedToOnCommand=zoom,16/24;diffuse,color("#808080");shadowlength,0;maxwidth,150;NoStroke



[ScreenTestInput]
PrevScreen="ScreenOptionsService"
NextScreen="ScreenOptionsService"
HeaderOnCommand=visible,false
FooterOnCommand=visible,false


[ScreenOptionsManageProfiles]
OptionRowNormalMetricsGroup="OptionRowProfile"
RowPositionTransformFunction=function(self,offsetFromCenter,itemIndex,numItems) \
	self:y(_screen.cy-172 + (_screen.h*0.065*itemIndex)) \
end



[OptionRowProfile]
Fallback="OptionRowSimple"
ItemOnCommand=shadowlength,0;zoom,0.75;y,-1;strokecolor,color("0,0,0,0.35");halign,0



###########################################################
#### MiniMenu stuff ####

[ScreenMiniMenu]
HeaderOnCommand=visible,false
FooterOnCommand=visible,false
RowPositionTransformFunction=function(self,positionIndex,itemIndex,numItems) \
	self:y((_screen.h/numItems) * positionIndex + (_screen.h/numItems) * 0.5) \
end

[OptionRowMiniMenu]
Fallback="OptionRowSimple"

FrameX=_screen.cx
FrameOnCommand=diffusealpha,0.95
FrameGainFocusCommand=diffuse,color("#293238");diffusealpha,0.95
FrameLoseFocusCommand=diffuse,color("#071016");diffusealpha,0.95
FrameDisabledCommand=diffuse,color("#040404");diffusealpha,0.95

TitleX=_screen.cx-200
TitleOnCommand=halign,0;

ItemsStartX=_screen.cx-150
ItemsEndX=_screen.cx+280
ItemsGapX=14
ItemsLongRowP1X=_screen.cx-60
ItemsLongRowP2X=_screen.cx+100
ItemsLongRowSharedX=_screen.cx+150
ItemOnCommand=

ColorSelected=color("0.5,1,0.5,1")
ColorNotSelected=color("1,1,1,1")
ColorDisabled=color("0.65,0,0,1")
TweenSeconds=0

# "Return" in Edit Mode
[ScreenMiniMenuAreaMenu]
Fallback="ScreenMiniMenu"
RowPositionTransformFunction=function(self,offsetFromCenter,index,numItems) \
	local row_height = 32 \
	local scale_factor = 1 \
	if row_height * numItems > _screen.h then \
		scale_factor = ((_screen.h/numItems) / 32) \
		row_height = row_height * scale_factor \
		self:zoom(scale_factor) \
		self:x( _screen.cx - (_screen.cx * scale_factor)) \
	end \
	if numItems % 2 == 0 then \
		self:y( (_screen.h * 0.5) + row_height*(index - math.floor(numItems*0.5)) + row_height*0.5 ) \
	else \
		self:y( (_screen.h * 0.5) + row_height*(index - math.floor(numItems*0.5)) ) \
	end \
end

# "Escape" in Edit Mode
[ScreenMiniMenuMainMenu]
Fallback="ScreenMiniMenuAreaMenu"
# "Escape" and then "Edit Steps Information"
[ScreenMiniMenuStepsInformation]
Fallback="ScreenMiniMenuAreaMenu"


# "F4" in Edit Mode
[ScreenMiniMenuTimingDataInformation]
Fallback="ScreenMiniMenuAreaMenu"

[OptionRowMiniMenuTimingDataInformation]
Fallback="OptionRowMiniMenu"
TitleOnCommand=zoom,0.9;valign,0.65
ItemOnCommand=zoom,0.9;valign,0.65

# "F1" in Edit Mode
[ScreenMiniMenuEditHelp]
RowPositionTransformFunction=function(self,positionIndex,itemIndex,numItems) \
	if itemIndex < numItems/2 then \
		self:x( _screen.cx * 0.5 ) \
	else \
		self:x( _screen.cx * 1.7 ) \
	end \
	self:y(32 * (itemIndex % (numItems/2))) \
end

[OptionRowMiniMenuEditHelp]
Fallback="OptionRowMiniMenu"

FrameX=0
FrameOnCommand=diffuse,color("#071016");diffusealpha,0.95;halign,1
TitleOnCommand=x,0;halign,1
ItemOnCommand=x,10;halign,0

ColorDisabled=PlayerColor(PLAYER_1)


# For ScreenManageProfile
[ScreenMiniMenuContext]
Class="ScreenMiniMenu"
Fallback="ScreenOptionsSimple"
PrevScreen=
TimerSeconds=-1
ShowHelp=false
OptionRowNormalMetricsGroup="OptionRowMiniMenuContext"

ContainerOnCommand=zoom,1;accelerate,0.3;diffusealpha,1;
LineHighlightOnCommand=visible,false
HeaderOnCommand=visible,false
FooterOnCommand=visible,false
CursorOnCommand=visible,false
PageOnCommand=visible,false
ShowExplanations=false
ShowExitRow=false
AllowRepeatingChangeValueInput=true

[OptionRowMiniMenuContext]
TitleX=_screen.cx - _screen.w/3.5;
TitleOnCommand=zoom,0.8; halign,0; NoStroke;
TitleGainFocusCommand=diffuse,PlayerColor(PLAYER_1)
TitleLoseFocusCommand=diffuse,color("#FFFFFF")
TitleDisabledCommand=diffuse,color("#DDDDDD")

FrameX=_screen.cx - _screen.w/5 + WideScale(21.5,28.5);
FrameOnCommand=diffusealpha,0.95; zoomx, 1.175
FrameGainFocusCommand=diffuse,color("#293238"); diffusealpha,0.95;
FrameLoseFocusCommand=diffuse,color("#071016"); diffusealpha,0.95;
FrameDisabledCommand=diffuse,color("#040404"); diffusealpha,0.95;

ItemOnCommand=

### end MiniMenu stuff ###
###########################################################



###########################################################################
###		DEBUG SCREENS
###########################################################################

[ScreenSystemLayer]
CreditsP1X=SCREEN_LEFT+WideScale(38, 45)
CreditsP1Y=SCREEN_BOTTOM-8
CreditsP1OnCommand=horizalign,left;vertalign,bottom;zoom,WideScale(0.8, 0.9);

CreditsP2X=SCREEN_RIGHT-WideScale(38, 45)
CreditsP2Y=SCREEN_BOTTOM-8
CreditsP2OnCommand=horizalign,right;vertalign,bottom;zoom,WideScale(0.8, 0.9);

MessageX=SCREEN_LEFT+16
MessageY=SCREEN_TOP+16
MessageOnCommand=finishtweening;halign,0;x,SCREEN_LEFT+20;y,SCREEN_TOP+80;zoom,0.5;shadowlength,2;diffusealpha,1
MessageOffCommand=sleep,5;linear,0.5;diffusealpha,0

MessageFrameX=_screen.cx
MessageFrameY=SCREEN_TOP+28
MessageFrameOnCommand=
MessageFrameOffCommand=

# this is for the visual stats overlays that appear when a user
# presses F3+6
[ScreenStatsOverlay]
StatsX=SCREEN_RIGHT-16
StatsY=SCREEN_TOP+16
StatsOnCommand=halign,1;valign,0;zoom,0.65
SkipY=_screen.h - 85









[MusicWheel]
ShowRoulette=false
ShowPortal=false
ShowRandom=true
	
OnlyShowActiveSection=ThemePrefs.Get("MusicWheelStyle")=="IIDX" and true or false
HideActiveSectionTitle=false

# MusicWheel Commands
ItemTransformFunction=function(self,offsetFromCenter,itemIndex,numItems) self:y(offsetFromCenter * _screen.h/15) end
NumWheelItems=14
MostPlayedSongsToShow=50

# WheelItem Commands
MusicWheelItemSortOnCommand=zoomy,0;accelerate,0.2;zoomy,1
MusicWheelItemSortOffCommand=decelerate,0.2;zoomy,0

# Highlight Commands
HighlightOnCommand=diffuseshift;effectcolor1,0.8,0.8,0.8,0.3;effectcolor2,0.8,0.8,0.8,0.05
HighlightOffCommand=decelerate,0.2;diffusealpha,0


[MusicWheelItem]
# hack to recolor song titles back to white EVERY time
SongNameSetCommand=diffuse,color("#FFFFFF");
CourseOnCommand=zoom,1;maxwidth,240;

# ensure that very long titles don't go off-screen
SectionExpandedOnCommand=maxwidth,WideScale(240,310)
SectionCollapsedOnCommand=maxwidth,WideScale(240,310)

SectionCountX=_screen.w/4-6
SectionCountOnCommand=diffuse,color("#FFFFFF"); halign,1; diffusetopedge,color("1,1,1,1");zoom,0.75
RandomOnCommand=diffuseshift;effectcolor1,color("1,1,1,1");effectcolor2,color("#88EEFF");effectperiod,10;shadowlength,2

WheelNotifyIconOnCommand=zoom,0.95
WheelNotifyIconX=WideScale(140,182)

[TimingData]
GetReturnsNumbers=true

[TextBanner]
TitleOnCommand=shadowlength,1;halign,0;strokecolor,color("0,0,0,0.25");
SubtitleOnCommand=shadowlength,1;halign,0;strokecolor,color("0,0,0,0.25");
ArtistOnCommand=visible,false
AfterSetCommand=%TextBannerAfterSet


[FadingBanner]
BannerFadeFromCachedCommand=stoptweening;accelerate,0.1;diffusealpha,0


[ScreenSelectMusic]
PrevScreen=Branch.SSMCancel()
CodeNames="SortList,SortList2,SortList3"
CodeSortList="@Select-Start"
CodeSortList2=PREFSMAN:GetPreference("OnlyDedicatedMenuButtons") and "MenuLeft-MenuRight" or GAMESTATE:GetCurrentGame():GetName() == "pump" and "DownLeft-DownRight"
CodeSortList3=not PREFSMAN:GetPreference("OnlyDedicatedMenuButtons") and "Left-Right" or ""

# this allows us to override the normal sort select command
ModeMenuAvailable=false
SelectMenuAvailable=true
SelectMenuChangesDifficulty=true
TwoPartSelection=false

TimerMetricsGroup="MenuTimer"
TimerOnCommand=hide_if,not PREFSMAN:GetPreference("MenuTimer");draworder,102;
TimerSeconds=300

SampleMusicLoops=true
SampleMusicFallbackFadeInSeconds=1.5
DoRouletteOnMenuTimer=false

BannerX=0
BannerY=0
BannerOnCommand=scaletoclipped,418,164;visible,false;

HeaderOnCommand=y,-32;draworder,101;decelerate,0.15;y,0
FooterOnCommand=draworder,101

# wheel
MusicWheelX=_screen.cx+_screen.w/4-10
MusicWheelY=_screen.cy
MusicWheelOffCommand=linear,0.2;diffusealpha,0;

MusicWheelCodeMessageCommand=%function(self, params) \
	if not GAMESTATE:IsCourseMode() and (params.Name=="SortList" or params.Name=="SortList2" or params.Name=="SortList3") then \
		SCREENMAN:AddNewScreenToTop("ScreenSortList"); \
	end; \
end;
MusicWheelSortMessageCommand=%function(self, params) \
	self:ChangeSort('SortOrder_'..params.order) \
end;


[ScreenSelectCourse]
Class="ScreenSelectMusic"
Fallback="ScreenSelectMusic"

MusicWheelType="CourseWheel"
Codes="CourseCodeDetector"

HelpText=ScreenString("HelpTextSelectCourse")

[CourseWheel]
Fallback="MusicWheel"


[ScreenSelectCourseNonstop]
Fallback="ScreenSelectCourse"
MusicWheelType="CourseWheel"
Codes="CourseCodeDetector"



# Set codes mostly to empty strings to
# override codes declared in _fallback theme.
[CodeDetector]
PrevSteps1="Up,Up"
NextSteps1="Down,Down"

# Sorting should done via ScreenSortList
# which is accessed via codes under [ScreenSelectMusic]
NextSort1=""
NextSort2=""
NextSort3=""
NextSort4=""
CloseCurrentFolder="Up-Down"

# "pad codes" for gameplay modifiers I don't want
Mirror=""
Left=""
Right=""
Shuffle=""
SuperShuffle=""
NextTransform=""
NextScrollSpeed=""
PreviousScrollSpeed=""
NextAccel=""
NextEffect=""
NextAppearance=""
NextTurn=""
Reverse=""
HoldNotes=""
Mines=""
Dark=""
NextGroup=""
PrevGroup=""
Hidden=""
RandomVanish=""

# this has been replaced with Lua-driven screenshot saving
SaveScreenshot1=""
SaveScreenshot2=""

[CourseCodeDetector]
Fallback="CodeDetector"



## Gameplay ####################################################################
[StepsDisplayGameplay]
MeterOnCommand=visible,false

[ScreenGameplay]
PrevScreen=SelectMusicOrCourse()
NextScreen=Branch.AfterGameplay()

HeaderOnCommand=visible,false
FooterOnCommand=visible,false

ShowCreditDisplay=false
MemoryCardIcons=false
GiveUpSeconds=0.33
MusicFadeOutSeconds=0.25

ScoreP1OnCommand=visible,false
ScoreP2OnCommand=visible,false
#--#
LifeP1OnCommand=visible,false
LifeP2OnCommand=visible,false

# THANKS, SUJEET.
PlayerP1OnePlayerOneSideX=_screen.cx-(_screen.w*160/640)
PlayerP2OnePlayerOneSideX=_screen.cx+(_screen.w*160/640)
PlayerP1TwoPlayersTwoSidesX=_screen.cx-(_screen.w*160/640)
PlayerP2TwoPlayersTwoSidesX=_screen.cx+(_screen.w*160/640)
PlayerP1OnePlayerBothSidesX=_screen.cx
PlayerP2OnePlayerBothSidesX=_screen.cx



[Combo]
ShowComboAt=4
ShowMissesAt=4
NumberMaxZoomAt=3000
LabelOnCommand=
NumberOnCommand=



[HoldJudgment]
HoldJudgmentLetGoCommand=diffuse,1,1,1,1;zoom,0.4;linear,0.3;zoom,0.5;sleep,0.5;linear,0;diffuse,1,1,1,0
HoldJudgmentHeldCommand=diffuse,1,1,1,1;zoom,0.4;linear,0.3;zoom,0.5;sleep,0.5;linear,0;diffuse,1,1,1,0


## Eval ########################################################################

[GraphDisplay]
BodyWidth=300
BodyHeight=53


[GraphDisplay1]
Fallback="GraphDisplay"

[GraphDisplay2]
Fallback="GraphDisplay"

[GraphDisplay3]
Fallback="GraphDisplay"

[GraphDisplay4]
Fallback="GraphDisplay"

[GraphDisplay5]
Fallback="GraphDisplay"

[GraphDisplay6]
Fallback="GraphDisplay"

[GraphDisplay7]
Fallback="GraphDisplay"

[GraphDisplay8]
Fallback="GraphDisplay"

[GraphDisplay9]
Fallback="GraphDisplay"

[GraphDisplay10]
Fallback="GraphDisplay"

[GraphDisplay11]
Fallback="GraphDisplay"

[GraphDisplay12]
Fallback="GraphDisplay"



[ComboGraph]
BodyHeight=10
BodyWidth=300

[ComboGraphP1]
Fallback="ComboGraph"

[ComboGraphP2]
Fallback="ComboGraph"



[ScreenEvaluation]
TimerSeconds=60
ShowHeader=true
FooterOnCommand=visible,false

BannerWidth=334
BannerHeight=132

CodeNames="Screenshot"
CodeScreenshot="Select"

[ScreenEvaluationStage]
Fallback="ScreenEvaluation"
NextScreen="ScreenProfileSave"


[ScreenEvaluationNonstop]
Fallback="ScreenEvaluation"
NextScreen="ScreenProfileSave"


################################################################################
# summary #

[ScreenEvaluationSummary]
Fallback="ScreenEvaluation"
PrevScreen=AllowScreenNameEntry()
NextScreen=AllowScreenNameEntry()
TimerSeconds=60

# when true, this metric appears to sum all of the player's Window types together
# for exmaple, all W1 values are summed, all W2 values are summed, etc.
Summary=false
HeaderOnCommand=visible,false

CodeNames="MenuLeft,MenuRight,MenuUp,MenuDown,Left,Right,Up,Down,Screenshot"
CodeMenuLeft="MenuLeft"
CodeMenuRight="MenuRight"
CodeMenuUp="MenuUp"
CodeMenuDown="MenuDown"
CodeLeft="Left"
CodeRight="Right"
CodeUp="Up"
CodeDown="Down"
CodeScreenshot="Select"


[RollingNumbersEvaluation]
Fallback="RollingNumbers"
Commify=false
LeadingZeroMultiplyColor=color("#5A6166")
ApproachSeconds=1

[RollingNumbersEvaluationA]
Fallback="RollingNumbersEvaluation"
TextFormat="%04.0f"

[RollingNumbersEvaluationB]
Fallback="RollingNumbersEvaluation"
TextFormat="%03.0f"



[ScreenEdit]
ShowCreditDisplay=false

# I don't like the hardcoded HelpText and opt to use my own
# See: ./BGAnimations/ScreenEdit underlay.lua
EditHelpOnCommand=visible,false

InfoX=_screen.w-150
InfoY=36
InfoOnCommand=halign,0;valign,0;zoom,0.625;

SetModScreen="ScreenAttackMenu"

CurrentBeatFormat="%s:  %.3f\n"
CurrentSecondFormat="%s:  %.6f\n"
SnapToFormat="%s: %s\n"
SelectionBeatBeginFormat="%s:  %.3f"
SelectionBeatUnfinishedFormat=" ...\n"
SelectionBeatEndFormat="-%.3f\n"
DifficultyFormat="%s:  %s\n\n"

RoutinePlayerFormat="%s: %d\n"
DescriptionFormat="%s:  %s\n"
ChartNameFormat="%s:\n  %s\n"
StepAuthorFormat="%s:\n  %s\n"
ChartStyleFormat="%s:  %s\n"
MainTitleFormat="%s:\n  %s\n\n"
SubtitleFormat="%s:  %s\n"

SegmentTypeFormat="%s: %s\n"
TapNoteTypeFormat="%s: %s\n"

NumStepsFormat="\n%s: %d\n"
NumJumpsFormat="%s: %d\n"
NumHoldsFormat="%s: %d\n"
NumMinesFormat="%s: %d\n"
NumHandsFormat="%s: %d\n"
NumRollsFormat="%s: %d\n"
NumLiftsFormat="%s: %d\n"
NumFakesFormat="%s: %d\n"

NumStepsFormatTwoPlayer="%s: %d/%d\n"
NumJumpsFormatTwoPlayer="%s: %d/%d\n"
NumHoldsFormatTwoPlayer="%s: %d/%d\n"
NumMinesFormatTwoPlayer="%s: %d/%d\n"
NumHandsFormatTwoPlayer="%s: %d/%d\n"
NumRollsFormatTwoPlayer="%s: %d/%d\n"
NumLiftsFormatTwoPlayer="%s: %d/%d\n"
NumFakesFormatTwoPlayer="%s: %d/%d\n"

TimingModeFormat="\n%s: %s\n"
Beat0OffsetFormat="%s: %.3f secs\n"
PreviewStartFormat="%s: %.3f secs\n"
PreviewLengthFormat="%s: %.3f secs\n"

####################################################
# Metrics for ScreenEditMenu
[StepsDisplay]
ShowMeter=true
MeterSetCommand=%function(self, param) MESSAGEMAN:Broadcast("MeterSet") end;
ShowDescription=false

[ScreenEditMenu]
PrevScreen="ScreenTitleMenu"
ExplanationY=SCREEN_BOTTOM-84
ExplanationOnCommand=wrapwidthpixels,(_screen.w*0.8)*1.25;shadowlength,1;zoom,0.75
ExplanationOffCommand=diffusealpha,0

[EditMenu]
Arrows1X=WideScale(_screen.cx-160,_screen.cx-180)
Arrows2X=WideScale(_screen.cx+250,_screen.cx+280)
ArrowsEnabledCommand=%function(self)  self:diffuse(color("1,1,1,1")); self:zoom(WideScale(0.7,0.75)); MESSAGEMAN:Broadcast("EditMenuChange") end
ArrowsDisabledCommand=%function(self) self:diffuse(color("1,1,1,0.2")); self:zoom(WideScale(0.7,0.75)); MESSAGEMAN:Broadcast("EditMenuChange") end

GroupBannerX=_screen.cx+166
GroupBannerY=_screen.cy-153
GroupBannerHeight=90
GroupBannerWidth=36
GroupBannerOnCommand=scaletoclipped,90,36

SongBannerX=_screen.cx+166
SongBannerY=_screen.cy-110
SongBannerHeight=90
SongBannerWidth=36
SongBannerOnCommand=scaletoclipped,90,36

SongTextBannerX=_screen.cx - WideScale(45,30)
SongTextBannerY=_screen.cy-111

StepsDisplayX=_screen.cx+170
StepsDisplayY=_screen.cy-21

StepsDisplaySourceX=_screen.cx+170
StepsDisplaySourceY=_screen.cy+69

Label1OnCommand=shadowlength,1;NoStroke;zoom,0.8;x,_screen.cx-WideScale(240,320)
Label2OnCommand=shadowlength,1;NoStroke;zoom,0.8;x,_screen.cx-WideScale(240,320)
Label3OnCommand=shadowlength,1;NoStroke;zoom,0.8;x,_screen.cx-WideScale(240,320)
Label4OnCommand=shadowlength,1;NoStroke;zoom,0.8;x,_screen.cx-WideScale(240,320)
Label5OnCommand=shadowlength,1;NoStroke;zoom,0.8;x,_screen.cx-WideScale(240,320)
Label6OnCommand=shadowlength,1;NoStroke;zoom,0.8;x,_screen.cx-WideScale(240,320)
Label7OnCommand=shadowlength,1;NoStroke;zoom,0.8;x,_screen.cx-WideScale(240,320)


# group
Value1X=_screen.cx-130
Value1OnCommand=shadowlength,1;NoStroke;zoom,0.8;halign,0

# song
Value2OnCommand=shadowlength,1;NoStroke;zoom,0.7;halign,0

# type
Value3X=_screen.cx-130
Value3OnCommand=shadowlength,1;NoStroke;zoom,0.8;halign,0

# steps
Value4X=_screen.cx-130
Value4OnCommand=shadowlength,1;NoStroke;zoom,0.8;halign,0

# fill type
Value5X=_screen.cx-130
Value5OnCommand=shadowlength,1;NoStroke;zoom,0.8;halign,0

# fill steps
Value6X=_screen.cx-130
Value6OnCommand=shadowlength,1;NoStroke;zoom,0.8;halign,0

# action
Value7X=_screen.cx-130
Value7OnCommand=shadowlength,1;NoStroke;zoom,0.8;halign,0

# rows are hardcoded to be 45px tall
Row1Y=_screen.cy-154
Row2Y=_screen.cy-111
Row3Y=_screen.cy-66
Row4Y=_screen.cy-21
Row5Y=_screen.cy+24
Row6Y=_screen.cy+69
Row7Y=_screen.cy+114

# End metrics for ScreenEditMenu
####################################################
######################################


###########################################################################
###		MISC VISUAL ELEMENTS
###########################################################################
[MenuTimer]
FrameOnCommand=visible,false;
Text1FormatFunction=function(fSeconds) fSeconds=math.min( 999, math.ceil(fSeconds) ); local digit = math.floor(fSeconds); return ""..digit end

Warning6Command=stoptweening;sleep,0.8;linear,0.2;glow,1,1,1,1;
Warning5Command=stoptweening;linear,0.2;glow,1,1,1,0;diffuseshift;effectperiod,1;effectcolor1,HSVA(0,0,1,0.5);effectcolor2,HSVA(0,1,1,0.9)
Warning4Command=stoptweening;linear,0.2
Warning3Command=stoptweening;linear,0.2
Warning2Command=stoptweening;linear,0.2
Warning1Command=stoptweening;linear,0.2
Warning0Command=stoptweening;stopeffect;linear,0.2;zoomx,1
WarningBeepStart=8
Text1OnCommand=stopeffect;stoptweening;shadowlength,0;y,16;zoom,0.5
Text2OnCommand=visible,false


[HelpDisplay]
TipShowTime=3.5
TipOnCommand=shadowlength,1;diffuseshift;effectperiod,1.25


###########################################################################
###		CORE SETTINGS
###########################################################################
[Gameplay]
MinScoreToMaintainCombo=GetComboThreshold()['Maintain']
MinScoreToContinueCombo=GetComboThreshold()['Continue']

[PlayerStageStats]
# copied directly from freem's ITG3 port
NumGradeTiersUsed=17
GradeTier01IsAllW2s=false
GradeTier02IsAllW2s=false
# ★★★★
GradePercentTier01=1.00
# ★★★
GradePercentTier02=0.99
# ★★
GradePercentTier03=0.98
# ★
GradePercentTier04=0.96
# S+
GradePercentTier05=0.94
# S
GradePercentTier06=0.92
# S-
GradePercentTier07=0.89
# A+
GradePercentTier08=0.86
# A
GradePercentTier09=0.83
# A-
GradePercentTier10=0.80
# B+
GradePercentTier11=0.76
# B
GradePercentTier12=0.72
# B-
GradePercentTier13=0.68
# C+
GradePercentTier14=0.64
# C
GradePercentTier15=0.60
# C-
GradePercentTier16=0.55
# D
GradePercentTier17=-999

[SongManager]
NumSongGroupColors=12
SongGroupColor1=GetHexColor(1)
SongGroupColor2=GetHexColor(2)
SongGroupColor3=GetHexColor(3)
SongGroupColor4=GetHexColor(4)
SongGroupColor5=GetHexColor(5)
SongGroupColor6=GetHexColor(6)
SongGroupColor7=GetHexColor(7)
SongGroupColor8=GetHexColor(8)
SongGroupColor9=GetHexColor(9)
SongGroupColor10=GetHexColor(10)
SongGroupColor11=GetHexColor(11)
SongGroupColor12=GetHexColor(12)

NumCourseGroupColors=1
CourseGroupColor1=Color.White

# This sets an integer threshhold for each song's charts' meters
# if a meter is above this threshhold, color the song name differently.
# We don't want this in Simply Love, so set it arbitrarily high.
ExtraColorMeter=999999


# Hardcode these to reflect those of ITG
[LifeMeterBar]
LifePercentChangeW1=0.008
LifePercentChangeW2=0.008
LifePercentChangeW3=0.004
LifePercentChangeW4=0.000
LifePercentChangeW5=-0.050
LifePercentChangeMiss=-0.100
LifePercentChangeHitMine=-0.050
LifePercentChangeHeld=IsGame("pump") and 0.000 or 0.008
LifePercentChangeLetGo=IsGame("pump") and 0.000 or -0.080


[ScoreKeeperNormal]
PercentScoreWeightHeld=5
PercentScoreWeightHitMine=-6
PercentScoreWeightLetGo=0
PercentScoreWeightW1=5
PercentScoreWeightW2=4
PercentScoreWeightW3=2
PercentScoreWeightW4=0
PercentScoreWeightW5=-6
PercentScoreWeightMiss=-12

GradeWeightHeld=5
GradeWeightHitMine=-6
GradeWeightLetGo=0
GradeWeightW1=5
GradeWeightW2=4
GradeWeightW3=2
GradeWeightW4=0
GradeWeightW5=-6
GradeWeightMiss=-12

[Player]
# Because Simply Love allows absurdly small playfields (via 150% mini)
# increase the normal DrawDistanceBefore, otherwise arrows appear suddenly.
DrawDistanceBeforeTargetsPixels=_screen.h*1.5
DrawDistanceAfterTargetsPixels=-114
ReceptorArrowsYStandard=-125
ReceptorArrowsYReverse=145
PenalizeTapScoreNone=false
PercentUntilColorCombo=0.20
ComboUnderField=true

[Profile]
ShowCoinData=true
UnlockAuthString=""
CustomLoadFunction=LoadProfileCustom
CustomSaveFunction=SaveProfileCustom



